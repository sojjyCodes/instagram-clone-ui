{"ast":null,"code":"'use strict';\n\nimport _extends from \"@babel/runtime/helpers/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/home/ebenezer/Project/Mobile Dev/instagram-clone-ui/node_modules/react-native-base/Components/Widgets/DeckSwiper.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport clamp from 'clamp';\nimport Animated from \"react-native-web/dist/exports/Animated\";\nimport PanResponder from \"react-native-web/dist/exports/PanResponder\";\nimport NativeBaseComponent from \"../Base/NativeBaseComponent\";\nimport View from \"./View\";\nvar SWIPE_THRESHOLD = 120;\n\nvar CardSwiper = function (_NativeBaseComponent) {\n  _inherits(CardSwiper, _NativeBaseComponent);\n\n  var _super = _createSuper(CardSwiper);\n\n  function CardSwiper(props) {\n    var _this;\n\n    _classCallCheck(this, CardSwiper);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      pan: new Animated.ValueXY(),\n      pan2: new Animated.ValueXY(),\n      enter: new Animated.Value(0.8),\n      selectedItem: _this.props.dataSource[0],\n      selectedItem2: _this.props.dataSource[1],\n      card1Top: true,\n      card2Top: false,\n      fadeAnim: new Animated.Value(0.8)\n    };\n    return _this;\n  }\n\n  _createClass(CardSwiper, [{\n    key: \"getInitialStyle\",\n    value: function getInitialStyle() {\n      return {\n        topCard: {\n          position: 'absolute',\n          top: 0,\n          right: 0,\n          left: 0\n        }\n      };\n    }\n  }, {\n    key: \"findNextIndexes\",\n    value: function findNextIndexes() {\n      var currentIndex = this.props.dataSource.indexOf(this.state.selectedItem);\n      var newIdx = currentIndex + 1;\n      var newIdx2 = currentIndex + 2;\n\n      if (newIdx2 > this.props.dataSource.length - 1 && newIdx === this.props.dataSource.length - 1) {\n        return [newIdx, 0];\n      } else if (newIdx > this.props.dataSource.length - 1) {\n        return [0, 1];\n      } else {\n        return [newIdx, newIdx2];\n      }\n    }\n  }, {\n    key: \"selectNext\",\n    value: function selectNext() {\n      var _this2 = this;\n\n      var nextIndexes = this.findNextIndexes();\n      setTimeout(function () {\n        _this2.setState({\n          selectedItem: _this2.props.dataSource[nextIndexes[0]]\n        });\n\n        setTimeout(function () {\n          _this2.setState({\n            selectedItem2: _this2.props.dataSource[nextIndexes[1]]\n          });\n        }, 350);\n      }, 50);\n    }\n  }, {\n    key: \"swipeRight\",\n    value: function swipeRight() {\n      var _this3 = this;\n\n      if (this.props.onSwiping) this.props.onSwiping('right');\n      setTimeout(function () {\n        Animated.timing(_this3.state.fadeAnim, {\n          toValue: 1\n        }).start();\n        Animated.spring(_this3.state.enter, {\n          toValue: 1,\n          friction: 7\n        }).start();\n\n        _this3.selectNext();\n\n        Animated.decay(_this3.state.pan, {\n          velocity: {\n            x: 8,\n            y: 1\n          },\n          deceleration: 0.98\n        }).start(_this3._resetState.bind(_this3));\n      }, 300);\n    }\n  }, {\n    key: \"swipeLeft\",\n    value: function swipeLeft() {\n      var _this4 = this;\n\n      if (this.props.onSwiping) this.props.onSwiping('left');\n      setTimeout(function () {\n        Animated.timing(_this4.state.fadeAnim, {\n          toValue: 1\n        }).start();\n        Animated.spring(_this4.state.enter, {\n          toValue: 1,\n          friction: 7\n        }).start();\n\n        _this4.selectNext();\n\n        Animated.decay(_this4.state.pan, {\n          velocity: {\n            x: -8,\n            y: 1\n          },\n          deceleration: 0.98\n        }).start(_this4._resetState.bind(_this4));\n      }, 300);\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this5 = this;\n\n      this._panResponder = PanResponder.create({\n        onMoveShouldSetResponderCapture: function onMoveShouldSetResponderCapture() {\n          return true;\n        },\n        onMoveShouldSetPanResponderCapture: function onMoveShouldSetPanResponderCapture(evt, gestureState) {\n          return Math.abs(gestureState.dx) > 5;\n        },\n        onPanResponderGrant: function onPanResponderGrant(e, gestureState) {\n          _this5.state.pan.setOffset({\n            x: _this5.state.pan.x._value,\n            y: _this5.state.pan.y._value\n          });\n\n          _this5.state.pan.setValue({\n            x: 0,\n            y: 0\n          });\n        },\n        onPanResponderMove: function onPanResponderMove(e, gestureState) {\n          if (gestureState.dx > 20) {\n            if (_this5.props.onSwiping) _this5.props.onSwiping('right', gestureState.dx);\n          } else if (gestureState.dx < -20) {\n            if (_this5.props.onSwiping) _this5.props.onSwiping('left', gestureState.dx);\n          }\n\n          var val = Math.abs(gestureState.dx * .0013);\n          var opa = Math.abs(gestureState.dx * .0022);\n\n          if (val > 0.2) {\n            val = 0.2;\n          }\n\n          Animated.timing(_this5.state.fadeAnim, {\n            toValue: 0.8 + val\n          }).start();\n          Animated.spring(_this5.state.enter, {\n            toValue: 0.8 + val,\n            friction: 7\n          }).start();\n          Animated.event([null, {\n            dx: _this5.state.pan.x\n          }])(e, gestureState);\n        },\n        onPanResponderRelease: function onPanResponderRelease(e, _ref) {\n          var vx = _ref.vx,\n              vy = _ref.vy;\n          if (_this5.props.onSwiping) _this5.props.onSwiping(null);\n          var velocity;\n\n          if (vx >= 0) {\n            velocity = clamp(vx, 4.5, 10);\n          } else if (vx < 0) {\n            velocity = clamp(vx * -1, 4.5, 10) * -1;\n          }\n\n          if (Math.abs(_this5.state.pan.x._value) > SWIPE_THRESHOLD) {\n            if (velocity > 0) {\n              _this5.props.onSwipeRight ? _this5.props.onSwipeRight() : undefined;\n\n              _this5.selectNext();\n            } else {\n              _this5.props.onSwipeLeft ? _this5.props.onSwipeLeft() : undefined;\n\n              _this5.selectNext();\n            }\n\n            Animated.decay(_this5.state.pan, {\n              velocity: {\n                x: velocity,\n                y: vy\n              },\n              deceleration: 0.98\n            }).start(_this5._resetState.bind(_this5));\n          } else {\n            Animated.spring(_this5.state.pan, {\n              toValue: {\n                x: 0,\n                y: 0\n              },\n              friction: 4\n            }).start();\n          }\n        }\n      });\n    }\n  }, {\n    key: \"_resetState\",\n    value: function _resetState() {\n      this.state.pan.setValue({\n        x: 0,\n        y: 0\n      });\n      this.state.enter.setValue(0.8);\n      this.state.fadeAnim.setValue(0.8);\n      this.setState({\n        card1Top: !this.state.card1Top,\n        card2Top: !this.state.card2Top\n      });\n      if (this.props.onSwiping) this.props.onSwiping(null);\n    }\n  }, {\n    key: \"getCardStyles\",\n    value: function getCardStyles() {\n      var _this$state = this.state,\n          pan = _this$state.pan,\n          pan2 = _this$state.pan2,\n          enter = _this$state.enter;\n      var _ref2 = [pan.x, pan.y],\n          translateX = _ref2[0],\n          translateY = _ref2[1];\n      var rotate = pan.x.interpolate({\n        inputRange: [-700, 0, 700],\n        outputRange: ['-10deg', '0deg', '10deg']\n      });\n      var opacity = pan.x.interpolate({\n        inputRange: [-320, 0, 320],\n        outputRange: [0.9, 1, 0.9]\n      });\n      var scale = enter;\n      var animatedCardStyles = {\n        transform: [{\n          translateX: translateX\n        }, {\n          translateY: translateY\n        }, {\n          rotate: rotate\n        }],\n        opacity: opacity\n      };\n      var animatedCardStyles2 = {\n        transform: [{\n          scale: scale\n        }]\n      };\n      return [animatedCardStyles, animatedCardStyles2];\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this6 = this;\n\n      return React.createElement(View, {\n        ref: function ref(c) {\n          return _this6._root = c;\n        },\n        style: {\n          position: 'relative',\n          flexDirection: 'column'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 13\n        }\n      }, this.state.selectedItem === undefined ? React.createElement(View, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 143\n        }\n      }) : React.createElement(View, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 18\n        }\n      }, React.createElement(Animated.View, _extends({\n        style: [this.getCardStyles()[1], {\n          opacity: this.state.fadeAnim\n        }]\n      }, this._panResponder.panHandlers, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 21\n        }\n      }), this.props.renderBottom ? this.props.renderBottom(this.state.selectedItem2) : this.props.renderItem(this.state.selectedItem2)), React.createElement(Animated.View, _extends({\n        style: [this.getCardStyles()[0], this.getInitialStyle().topCard]\n      }, this._panResponder.panHandlers, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 21\n        }\n      }), this.props.renderTop ? this.props.renderTop(this.state.selectedItem) : this.props.renderItem(this.state.selectedItem))));\n    }\n  }]);\n\n  return CardSwiper;\n}(NativeBaseComponent);\n\nexport { CardSwiper as default };","map":{"version":3,"sources":["/home/ebenezer/Project/Mobile Dev/instagram-clone-ui/node_modules/react-native-base/Components/Widgets/DeckSwiper.js"],"names":["React","clamp","NativeBaseComponent","View","SWIPE_THRESHOLD","CardSwiper","props","state","pan","Animated","ValueXY","pan2","enter","Value","selectedItem","dataSource","selectedItem2","card1Top","card2Top","fadeAnim","topCard","position","top","right","left","currentIndex","indexOf","newIdx","newIdx2","length","nextIndexes","findNextIndexes","setTimeout","setState","onSwiping","timing","toValue","start","spring","friction","selectNext","decay","velocity","x","y","deceleration","_resetState","bind","_panResponder","PanResponder","create","onMoveShouldSetResponderCapture","onMoveShouldSetPanResponderCapture","evt","gestureState","Math","abs","dx","onPanResponderGrant","e","setOffset","_value","setValue","onPanResponderMove","val","opa","event","onPanResponderRelease","vx","vy","onSwipeRight","undefined","onSwipeLeft","translateX","translateY","rotate","interpolate","inputRange","outputRange","opacity","scale","animatedCardStyles","transform","animatedCardStyles2","c","_root","flexDirection","getCardStyles","panHandlers","renderBottom","renderItem","getInitialStyle","renderTop"],"mappings":"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","sourcesContent":["/* @flow */\n'use strict';\n\nimport React from 'react';\nimport clamp from 'clamp';\nimport {Animated, PanResponder } from 'react-native';\nimport NativeBaseComponent from '../Base/NativeBaseComponent';\nimport View from './View';\n\nvar SWIPE_THRESHOLD = 120;\n\nexport default class CardSwiper extends NativeBaseComponent {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            pan: new Animated.ValueXY(),\n            pan2: new Animated.ValueXY(),\n            enter: new Animated.Value(0.8),\n            selectedItem : this.props.dataSource[0],\n            selectedItem2 : this.props.dataSource[1],\n            card1Top: true,\n            card2Top: false,\n            fadeAnim: new Animated.Value(0.8)\n        }\n    }\n\n    getInitialStyle() {\n        return {\n            topCard: {\n                position: 'absolute',\n                top: 0,\n                right: 0,\n                left: 0\n            }\n        }\n    }\n\n\n    findNextIndexes() {\n        let currentIndex = this.props.dataSource.indexOf(this.state.selectedItem);\n        let newIdx = currentIndex + 1;\n        let newIdx2 = currentIndex + 2;\n\n        if(newIdx2 > this.props.dataSource.length - 1 && newIdx === this.props.dataSource.length - 1) {\n            return [newIdx, 0];\n        } else if (newIdx > this.props.dataSource.length - 1) {\n            return [0, 1];\n        } else {\n            return [newIdx, newIdx2];\n        }\n    }\n\n    selectNext() {\n        let nextIndexes = this.findNextIndexes();\n        setTimeout( () => {\n            this.setState({\n                selectedItem: this.props.dataSource[nextIndexes[0]]\n            });\n            setTimeout( () => {\n                this.setState({\n                    selectedItem2: this.props.dataSource[nextIndexes[1]]\n                });\n            }, 350);\n        }, 50);\n    }\n\n\n    swipeRight() {\n      if(this.props.onSwiping)\n        this.props.onSwiping('right');\n      setTimeout( () => {\n        Animated.timing(\n          this.state.fadeAnim,\n          {toValue: 1}\n        ).start();\n        Animated.spring(\n          this.state.enter,\n          { toValue: 1, friction: 7 }\n        ).start();\n        this.selectNext();\n        Animated.decay(this.state.pan, {\n            velocity: {x: 8, y: 1},\n            deceleration: 0.98\n        }).start(this._resetState.bind(this))\n      }, 300);\n    }\n\n    swipeLeft() {\n      if(this.props.onSwiping)\n        this.props.onSwiping('left');\n      setTimeout( () => {\n        Animated.timing(\n          this.state.fadeAnim,\n          {toValue: 1}\n        ).start();\n        Animated.spring(\n          this.state.enter,\n          { toValue: 1, friction: 7 }\n        ).start();\n        this.selectNext();\n        Animated.decay(this.state.pan, {\n            velocity: {x: -8, y: 1},\n            deceleration: 0.98\n        }).start(this._resetState.bind(this))\n      }, 300);\n    }\n\n    componentWillMount() {\n        this._panResponder = PanResponder.create({\n            onMoveShouldSetResponderCapture: () => true,\n            onMoveShouldSetPanResponderCapture: (evt, gestureState) => {\n                return Math.abs(gestureState.dx) > 5;\n            },\n\n            onPanResponderGrant: (e, gestureState) => {\n                this.state.pan.setOffset({x: this.state.pan.x._value, y: this.state.pan.y._value});\n                this.state.pan.setValue({x: 0, y: 0});\n            },\n\n\n            onPanResponderMove: (e, gestureState) => {\n                if (gestureState.dx > 20){\n                  if(this.props.onSwiping)\n                    this.props.onSwiping('right',gestureState.dx);\n                }\n                else if (gestureState.dx < -20){\n                  if(this.props.onSwiping)\n                    this.props.onSwiping('left',gestureState.dx);\n                }\n                let val = Math.abs((gestureState.dx*.0013));\n                let opa = Math.abs((gestureState.dx*.0022));\n                if (val>0.2) {\n                    val = 0.2;\n                }\n                Animated.timing(\n                    this.state.fadeAnim,\n                    {toValue: 0.8+val}\n                ).start();\n                Animated.spring(\n                    this.state.enter,\n                    { toValue: 0.8+val, friction: 7 }\n                ).start();\n                Animated.event([\n                    null, {dx: this.state.pan.x},\n                ])(e, gestureState)\n            },\n\n            onPanResponderRelease: (e, {vx, vy}) => {\n                if(this.props.onSwiping)\n                  this.props.onSwiping(null);\n                var velocity;\n\n                if (vx >= 0) {\n                    velocity = clamp(vx, 4.5, 10);\n                } else if (vx < 0) {\n                    velocity = clamp(vx * -1, 4.5, 10) * -1;\n                }\n\n                if (Math.abs(this.state.pan.x._value) > SWIPE_THRESHOLD) {\n\n                    if (velocity>0) {\n                        (this.props.onSwipeRight) ? this.props.onSwipeRight() : undefined;\n                        this.selectNext();\n                    } else {\n                        (this.props.onSwipeLeft) ? this.props.onSwipeLeft() : undefined;\n                        this.selectNext();\n                    }\n\n                    Animated.decay(this.state.pan, {\n                        velocity: {x: velocity, y: vy},\n                        deceleration: 0.98\n                    }).start(this._resetState.bind(this))\n                } else {\n                    Animated.spring(this.state.pan, {\n                        toValue: {x: 0, y: 0},\n                        friction: 4\n                    }).start()\n                }\n            }\n        })\n    }\n\n    _resetState() {\n        this.state.pan.setValue({x: 0, y: 0});\n        this.state.enter.setValue(0.8);\n        this.state.fadeAnim.setValue(0.8);\n        this.setState({\n            card1Top: !this.state.card1Top,\n            card2Top: !this.state.card2Top\n        });\n        if(this.props.onSwiping)\n          this.props.onSwiping(null);\n\n    }\n\n    getCardStyles() {\n\n        let { pan, pan2, enter } = this.state;\n\n        let [translateX, translateY] = [pan.x, pan.y];\n        // let [translateX, translateY] = [pan2.x, pan2.y];\n\n        let rotate = pan.x.interpolate({inputRange: [-700, 0, 700], outputRange: ['-10deg', '0deg', '10deg']});\n\n        let opacity = pan.x.interpolate({inputRange: [-320, 0, 320], outputRange: [0.9, 1, 0.9]})\n        let scale = enter;\n\n        let animatedCardStyles = {transform: [{translateX}, {translateY}, {rotate}], opacity};\n        let animatedCardStyles2 = {transform: [{scale}]};\n\n        return [animatedCardStyles, animatedCardStyles2]\n    }\n\n    render() {\n\n\n        return(\n            <View ref={c => this._root = c} style={{position: 'relative', flexDirection: 'column'}}>{(this.state.selectedItem)===undefined ? (<View />) :\n                (<View>\n                    <Animated.View style={[this.getCardStyles()[1],{opacity: this.state.fadeAnim}]} {...this._panResponder.panHandlers}>\n                        {(this.props.renderBottom)  ?\n                          this.props.renderBottom(this.state.selectedItem2)\n                        :\n                          this.props.renderItem(this.state.selectedItem2)\n                        }\n                    </Animated.View>\n                    <Animated.View style={[ this.getCardStyles()[0], this.getInitialStyle().topCard] } {...this._panResponder.panHandlers} >\n                        {(this.props.renderTop) ?\n                          this.props.renderTop(this.state.selectedItem)\n                        :\n                          this.props.renderItem(this.state.selectedItem)\n                        }\n                    </Animated.View>\n                    </View>\n                )\n            }\n            </View>\n        );\n    }\n\n}\n"]},"metadata":{},"sourceType":"module"}